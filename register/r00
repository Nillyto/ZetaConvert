# ZetaConvert â€“ OrganizaciÃ³n del Proyecto

Este archivo documenta la organizaciÃ³n y funcionamiento del proyecto para poder retomarlo en otro chat o por otra persona en el futuro.

---

## ğŸ“‚ Estructura mÃ­nima de carpetas

```
project/
â”œâ”€â”€ main.py                # FastAPI app, rutas, lÃ³gica principal
â”œâ”€â”€ engines/
â”‚   â”œâ”€â”€ image_engine.py    # Motor para imÃ¡genes (convertir entre JPG, PNG, WEBP, PDF, GIFâ€¦)
â”‚   â””â”€â”€ pdf_engine.py      # Motor para PDFs (extraer a imÃ¡genes, comprimir, etc.)
â”œâ”€â”€ static/
â”‚   â”œâ”€â”€ css/
â”‚   â”‚   â””â”€â”€ styles.css     # Estilos completos (modo claro/oscuro, colores pastel, grises)
â”‚   â”œâ”€â”€ js/
â”‚   â”‚   â””â”€â”€ main.js        # Frontend: drag&drop, colas, redirecciones, barra progreso
â”‚   â”œâ”€â”€ formats.map.json   # CatÃ¡logo maestro de formatos y targets
â”‚   â”œâ”€â”€ formats.status.json# Habilitados o no (enabled true/false)
â”‚   â””â”€â”€ icons/             # Iconos PWA (192, 512)
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ base.html          # Layout base con header/footer
â”‚   â”œâ”€â”€ home.html          # PÃ¡gina inicial con cards de formatos
â”‚   â”œâ”€â”€ route.html         # PÃ¡gina de conversiÃ³n individual
â”‚   â”œâ”€â”€ privacy.html       # PolÃ­tica de privacidad
â”‚   â””â”€â”€ terms.html         # TÃ©rminos de uso
â””â”€â”€ tmp/                   # Archivos temporales de conversiÃ³n (se borra al descargar)
```

---

## ğŸ§© main.py

- **FastAPI + Starlette**:
  - Monta `/static` para CSS/JS/JSON.
  - Usa `templates` con Jinja2 para HTML.
  - Middleware de seguridad (CORS, headers).
  - Rate-limit (60/min) y tamaÃ±o mÃ¡x (20MB).

- **Rutas**:
  - `/` y `/routes`: muestran `home.html`.
  - `/r/{slug}`: muestra `route.html` para un conversor especÃ­fico.
  - `/api/convert`: endpoint de conversiÃ³n (usa `image_engine` o `pdf_engine`).
  - SEO: `/sitemap.xml`, `/robots.txt`, `/ads.txt`, `/manifest.webmanifest`.
  - Salud: `/healthz`.

- **ROUTES**: catÃ¡logo hardcodeado de conversores disponibles.
- **formats.json**: endpoint que devuelve dataset simplificado para buscador.

---

## ğŸ–¼ engines/

### image_engine.py
- Convierte imÃ¡genes entre: JPG, PNG, WEBP, PDF.
- Soporta resize opcional, calidad, strip de metadata.
- GIF/HEIC/AVIF marcados como premium/futuros.

### pdf_engine.py
- Convierte PDF a imÃ¡genes (PNG/JPG/WEBP).
- Soporta exportaciÃ³n de pÃ¡ginas especÃ­ficas.
- Puede devolver ZIP con todas las pÃ¡ginas.

---

## ğŸ¨ static/

### css/styles.css
- Paleta clara: blanco base, rojo pastel como secundario, grises/negros terciarios.
- Paleta oscura: grises mÃ¡s oscuros, rojo brillante/acento.
- Azul pastel para botones de descarga.
- Define tokens globales `--primary`, `--accent`, `--bg`, etc.
- Estilos para header, hero, panels, cards, forms, botones, progreso, tabs, popovers, badges, footer.
- Responsive (media queries 960px y 560px).
- Dropzone y cola de archivos.

### js/main.js
- Theme toggle (dark/light con localStorage).
- Manejo de formularios de conversiÃ³n:
  - drag&drop, paste, precompress (JPEG/WEBP).
  - submit con XHR + barra progreso.
- Vista cola multiarchivos:
  - agregar/quitar archivos.
  - progreso global.
  - conversiÃ³n en paralelo (pool 2).
- Filtros dinÃ¡micos:
  - carga `formats.map.json` + `formats.status.json`.
  - reconstruye `<select>` para mostrar solo formatos habilitados.

### formats.map.json
- CatÃ¡logo completo de ~300 formatos organizados por categorÃ­as:
  - `images`, `video`, `audio`, `documents`, `3d`, `utilities`.
- Cada formato tiene:
  - `id`, `ext`, `label`, `mime`, `targets`.
  - `premium: true` si es especial.

### formats.status.json
- Indica quÃ© formatos estÃ¡n habilitados (`enabled: true/false`).
- Hoy activos: `jpg`, `png`, `webp`, `pdf`, `zip`.
- El resto en `false` hasta que haya soporte.

---

## ğŸ“‘ templates/

- **base.html**: header/nav/footer, bloque hero, bloque content.
- **home.html**:
  - Muestra categorÃ­as de `ROUTES` como â€œcardsâ€.
  - Buscador JS (usa `/formats.json`).
- **route.html**:
  - Form de conversiÃ³n (file input, select de target).
  - Opciones avanzadas (calidad, resize, dpi, pÃ¡ginas).
  - JSON inyectado (`all_targets_json`, `target_to_slug_json`) para JS.
- **privacy.html** y **terms.html**: textos legales.

---

## ğŸ”„ Flujo de uso

1. Usuario entra al **home** â†’ ve cards (`home.html` â†’ `ROUTES`).
2. Elige un conversor (ej: `/r/jpg-to-png`).
3. `route.html` muestra el form â†’ selecciona archivo y formato destino.
4. JS (`main.js`) gestiona drag&drop, envÃ­o AJAX, progreso.
5. Backend (`main.py`) llama `image_engine` o `pdf_engine`.
6. Devuelve archivo convertido (con headers para descarga).
7. Descarga automÃ¡tica.

---

## ğŸ“Œ Nota final

- Para **activar nuevos formatos**, solo hace falta:
  1. Implementar soporte en `engines/`.
  2. Crear ruta en `ROUTES` (`main.py`) o endpoint nuevo.
  3. Poner `enabled: true` en `formats.status.json`.

